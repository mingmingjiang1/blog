---
title: 异步控制
date: 2024-6-23 23:32:24
tags: FE
categories: FE
---


## 异步并行



## 异步串行

``` javascript
const timeout = ms => new Promise((resolve, reject) => {
    setTimeout(() => {
        resolve();
    }, ms);
});

const ajax1 = () => timeout(2000).then(() => {
    console.log('1');
    return 1;
});

const ajax2 = () => timeout(1000).then(() => {
    console.log('2');
    return 2;
});

const ajax3 = () => timeout(2000).then(() => {
    console.log('3');
    return 3;
});

function mergePromise(arr) {
    const ret = [];

    return new Promise((resolve, reject) => {
        arr.reduce((pre, cur) => {
            return pre.then(cur).then(res => {
                ret.push(res);
                if (ret.length === arr.length) {
                    resolve(ret)
                }
            });
        }, Promise.resolve());
    })
}

mergePromise([ajax1, ajax2, ajax3]).then(data => {
    console.log('done');
    console.log(data); // data 为 [1, 2, 3]
});

 ```
